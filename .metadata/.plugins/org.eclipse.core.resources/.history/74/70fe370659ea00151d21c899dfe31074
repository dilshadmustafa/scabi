/**
 * @author Dilshad Mustafa
 * (c) Dilshad Mustafa
 * All Rights Reserved.
 * @version 1.0
 * @since 10-Mar-2016
 * File Name : DResultSetNew.java
 */
package com.dilmus.dilshad.scabi.common;

/**
 * @author Dilshad Mustafa
 *
 */

import com.mongodb.DBCursor;
import com.mongodb.client.FindIterable;
import com.mongodb.client.MongoCursor;
import org.bson.Document;

/**
 * @author Dilshad Mustafa
 *
 */
public class DResultSet {

	MongoCursor<?> m_cursor = null;
	DDocument m_dob = null;
	FindIterable<?> m_findIterable = null;
	
	public DResultSet(FindIterable<?> findIterable) {
		m_findIterable = findIterable;
		m_cursor = findIterable.iterator();
		m_dob = new DDocument();
	}

	public DResultSet() {
		m_cursor = null;
		m_dob = new DDocument();
	}
	
	public int set(FindIterable<?> findIterable) {
		m_findIterable = findIterable;
		m_cursor = findIterable.iterator();
		return 0;
	}
	
	public boolean hasNext() {
		return m_cursor.hasNext();
	}
	
	public DDocument next() {
		m_dob.set((Document)m_cursor.next());
		return m_dob;
	}
	
	public DDocument nextDirect() {
		return new DDocument((Document)m_cursor.next());
	}
	
	/*
	public int count() {
		return m_cursor..count();
	}
	*/
}
